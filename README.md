# –ü–æ—è—Å–Ω–µ–Ω–∏–µ 
## –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é To Do List –Ω–∞ FastAPI –≤ —Ä–∞–º–∫–∞—Ö –¥–∏–ø–ª–æ–º–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å—Ç—É–¥–µ–Ω—Ç–∞ 
## –ê–±—Ä–∞–º–æ–≤–∞ –ê–Ω–¥—Ä–µ—è –í–∞—Å–∏–ª—å–µ–≤–∏—á–∞

–ò—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞:  
https://fastapi.qubitpi.org/tutorial/  

https://metanit.com/python/fastapi/


–ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
![project_tree](https://github.com/andrzejabramov/ToDoList_FastApi/blob/master/screens/project_tree.png)

FastAPI - –æ–¥–∏–Ω –∏–∑ —Ç—Ä–µ—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –º—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–µ–º –¥–∞–Ω–Ω–æ–µ –ø—Ä–æ—Å—Ç–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Flask, FastAPI, Django.
–ü–æ–¥–≥–æ—Ç–æ–≤–∏–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –≤ –∫–æ—Ç–æ—Ä–æ–µ –¥–æ–±–∞–≤–∏–º –ø–æ–º–∏–º–æ —Å–∞–º–æ–≥–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞ python12 - uvicorn, SQLAlchemy, Jinja2, alembic.  
–§–æ—Ä–º–∏—Ä—É–µ–º –¥–µ—Ä–µ–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞: —Ñ–∞–π–ª main.py, –ø–∞–∫–µ—Ç views —Å —Ñ–∞–π–ª–æ–º –¥–ª—è —Ä–æ—É—Ç–µ—Ä–æ–≤, –¥–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –≤ –ë–î –∏ –Ω–∞ –≤–µ–± —Å—Ç—Ä–∞–Ω–∏—Ü–µ.  
–ö—Ä–æ–º–µ —ç—Ç–æ–≥–æ: —Å–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é templates –¥–ª—è —à–∞–±–ª–æ–Ω–æ–≤ HTML, –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é models –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ë–î.  
–°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª config –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç–æ—Ä–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î.  

–§–∞–π–ª main.py —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Ä–æ—É—Ç–µ—Ä–∞–º –∏ —Ç–∏–ø–æ–≤—É—é –¥–∏—Ä–µ–∫—Ç–∏–≤—É –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
```commandline
from fastapi import FastAPI
import uvicorn
from views.todo_items import router as todo_items_router

app = FastAPI()
app.include_router(todo_items_router)


if __name__ == '__main__':
    uvicorn.run(
        "main:app",
        host="0.0.0.0",
        port=8000,
        reload=True,
    )
```
–í –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ models –≤ —Ñ–∞–π–ª–µ base.py –æ–±—ä–≤–ª—è–µ—Ç—Å—è –∫–ª–∞—Å—Å Base –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è DeclarativeBase –∏–∑ –ø–∞–∫–µ—Ç–∞ sqlalchemy.orm 
–í —Ñ–∞–π–ª–µ db.py –æ–±—ä—è–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î –∏ —Ñ—É–Ω–∫—Ü–∏—è - –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–µ—Å—Å–∏–π:
```commandline
engine = create_engine(config.SQLITE_DB_URI)

def get_session() -> Session:
    with Session(engine) as session:
        yield session
```
–í —Ñ–∞–π–ª–µ todo_items.py - —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ –≤–∏–¥–µ –∫–ª–∞—Å—Å–∞ TodoItem(Base) –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è Base —Ç–∞–±–ª–∏—Ü–∞ todo_items:  
c —Ç—Ä–µ–º—è –ø–æ–ª—è–º–∏:   
id (–∫–ª—é—á–µ–≤–æ–µ, int),   
text (str) - —Ç–µ–∫—Å—Ç –∑–∞–ø–∏—Å–∏ –∑–∞–¥–∞–Ω–∏—è,  
done (bool) - —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è (–≤—ã–ø–æ–ª–Ω–µ–Ω–æ –∏–ª–∏ –Ω–µ—Ç), –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é False
–ú–∞–≥–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∫–æ–Ω—Å–æ–ª–∏ –ø—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ.  

–†–∞–∑–±–∏—Ä–∞–µ–º —Ä–æ—É—Ç–µ—Ä—ã:
–¢–∞–∫ –∫–∞–∫ —É –Ω–∞—Å –≤ —Ä–æ—É—Ç–µ—Ä–∞—Ö –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è id –∑–∞–ø–∏—Å–∏, –µ—Å—Ç—å —Å–º—ã—Å–ª –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–¥–∞ —Å–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–æ–≤–µ—Ä–∫–∏ (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å):
```commandline
def todo_dependency(todo_id: int,
                    session: Session = Depends(get_session)
                    ) -> TodoItem:
    todo: TodoItem | None = session.get(TodoItem, todo_id)
    if todo is None:
        raise HTTPException(
            status_code=status.HTTP_404_NOT_FOUND,
            detail=f"Todo {todo_id} not found"
        )
    return todo
```
–µ—Å–ª–∏ —Å–µ—Å—Å–∏—è –≤–µ—Ä–Ω—É–ª–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π id –∑–∞–ø–∏—Å–∏, —Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å–∞–º–∞ –∑–∞–ø–∏—Å—å, –µ—Å–ª–∏ –∑–∞–ø–∏—Å—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ - –æ—à–∏–±–∫–∞.  

–ó–∞–¥–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é router –∫–∞–∫ —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ APIRouter.  
1. –ü–µ—Ä–≤—ã–π —Ä–æ—É—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π –∏–∑ –ë–î –≤ —à–∞–±–ª–æ–Ω –Ω–∞ –≤–µ–± —Å—Ç—Ä–∞–Ω–∏—Ü—É:
```commandline
@router.get("/", name="todo-list")
def list_todos(
        request: Request,
        session: Session = Depends(get_session)
):
    return templates.TemplateResponse(
        "index.html",
        context={
            "request": request,
            "todos": session.query(TodoItem).order_by(TodoItem.id).all(),
        },
    )
```
Get —Ä–æ—É—Ç –ø–æ –∫–æ—Ä–Ω–µ–≤–æ–º—É –∞–¥—Ä–µ—Å—É, —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –∑–∞–ø—Ä–æ—Å, —Å–µ—Å—Å–∏—é, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —à–∞–±–ª–æ–Ω —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –∑–∞–ø—Ä–æ—Å–∞ –∏ —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞–Ω–∏–π
2. –†–æ—É—Ç–µ—Ä –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏:
```commandline
@router.post("/", name="add-todo")
def add_todo(
        request: Request,
        todo_text: str = Form(..., alias="todo-text"),
        session: Session = Depends(get_session),
):
    todo_item = TodoItem(text=todo_text)
    session.add(todo_item)
    session.commit()
    return RedirectResponse(
        url=request.url_for("todo-list"),
        status_code=status.HTTP_302_FOUND,
    )
```
Post —Ä–æ—É—Ç –ø–æ –∫–æ—Ä–Ω–µ–≤–æ–º—É –∞–¥—Ä–µ—Å—É —Å –∏–º–µ–∏–µ–º add-todo –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ request, alias —Ñ–æ—Ä–º—ã —à–∞–±–ª–æ–Ω–∞, —Å–µ—Å—Å–∏—é.
–ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ –ë–î –≤–≤–µ–¥–µ–Ω–Ω–æ–µ –≤ —Ñ–æ—Ä–º—É —à–∞–±–æ—Ä–Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–µ, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å—å—é.
3. –†–æ—É—Ç –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏. –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –µ—Å—Ç—å –ª–∏ –∑–∞–ø–∏—Å—å —Å —Ç–∞–∫–∏–º id:
```commandline
@router.post("/{todo_id}/delete/", name="delete-todo")
def delete_todo(
        request: Request,
        session: Session = Depends(get_session),
        todo: TodoItem = Depends(todo_dependency),
):
    session.delete(todo)
    session.commit()
    return RedirectResponse(
        url=request.url_for("todo-list"),
        status_code=status.HTTP_302_FOUND,
    )
```
–ü–æ –∞–¥—Ä–µ—Å—É /id/delete, –∏–º—è –¥–ª—è —à–∞–±–ª–æ–Ω–∞ delete-todo, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ request, —Å–µ—Å—Å–∏—é, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –µ—Å—Ç—å –ª–∏ –∑–∞–ø–∏—Å—å, –≤—ã–∑—ã–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—é todo_dependency(), –ø—Ä–æ–∏–∑–≤–æ–¥–∂–∏—Ç —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –ë–î –∏ —Å –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—ã.  
4. –†–æ—É—Ç –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏ (–≤—ã–ø–æ–ª–Ω–µ–Ω–∞/–Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞) —Ç–∞–∫ –∂–µ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –Ω–∞–ª–∏—á–∏—è –∑–∞–ø–∏—Å–∏:  
```commandline
@router.post("/{todo_id}/toggle", name="toggle-todo")
def toggle_todo(
        request: Request,
        session: Session = Depends(get_session),
        todo: TodoItem = Depends(todo_dependency),
):
    todo.done = not todo.done
    session.commit()
    return RedirectResponse(
        url=request.url_for("todo-list"),
        status_code=status.HTTP_302_FOUND,
    )
```
–ü–æ –∞–¥—Ä–µ—Å—É id/toggle (–∏–º—è –¥–ª—è —à–∞–±–ª–æ–Ω–∞ toggle-todo) post –∑–≤–ø—Ä–æ—Å —Å –≤—Ö–æ–¥–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ request, —Å–µ—Å—Å–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å –≤ –ë–î.
–ï—Å–ª–∏ –¥–∞, —Ç–æ –º–µ–Ω—è–µ—Ç—Å—è –±—É–ª–µ–≤–æ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –Ω–∞ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—É (–Ω–∞—á–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞) –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–π –≤–∏–¥.

–û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤–µ–±-—à–∞–±–ª–æ–Ω–∞ –Ω–∞ Jinja2 (—Ä–∞–∑–±–∏—Ä–∞–µ–º –±–ª–æ–∫ body):
–í—Å–µ –ø–æ–º–µ—â–µ–Ω–æ –≤ –æ–¥–∏–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä <div>, –≤–Ω—É—Ç—Ä–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ:
1. –±–ª–æ–∫ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è —Å —Ç–µ–≥–æ–º <h3>: Add new todo:
```commandline
<h3>Add new todo</h3>
    <div>
        <form method="post" enctype="application/x-www-form-urlencoded">
        <label for="todo-text-id">New todo:</label>
        <input
                id="todo-text-id"
                name="todo-text"
                type="text"
                required="required"
        >
            <button type="submit">ADD</button>
        </form>
    </div>
```
2. –ë–ª–æ–∫, —Å —Ç–µ–≥–æ–º <h3>: Todos, —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ —Å–ø–∏—Å–∫–∞ <ul>, —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ü–∏–∫–ª–∞ –ø–æ –∑–∞–ø–∏—Å—è–º <li>:
- –ø–µ—Ä–≤–∞—è —Ñ–æ—Ä–º–∞ –∑–∞–¥–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ –¥–ª—è –∫–Ω–æ–ø–∫–∏ ‚ñ∂Ô∏è–∏ –≤—ã–∑—ã–≤–∞–µ—Ç —Ä–æ—É—Ç–µ—Ä toggle-todo, –ø—Ä–∏ —ç—Ç–æ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —ç–º–æ–¥–∑–∏ ‚úÖ –∏ üîò—Å–º–µ–Ω—è—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞.
- –≤—Ç–æ—Ä–∞—è —Ñ–æ—Ä–º–∞ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ —ç–º–æ–¥–∑–∏ ‚ùå.

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: 
![project.tree.png](https://github.com/andrzejabramov/ToDoList_FastApi/blob/master/screens/project_tree.png)

